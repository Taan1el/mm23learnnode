"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getAssets = getAssets;

var _constants = require("../constants");

var _toVar = require("../utils/to-var");

var _getDynamicImport = require("./get-dynamic-import");

var _getDynamicMeta = require("./get-dynamic-meta");

/**
 * @param {Array.<ImportWrapper[]>} assets
 * @returns {{imports: function(Object, boolean): string}}
 */
function getAssets(assets) {
  function imports(loaderContext, esModule) {
    return assets.map(function ([assetPath, assetImport]) {
      const uuid = assetPath.getHash();
      const importVar = (0, _toVar.toVar)(`${_constants.IMPORTS_PREFIX}_asset_${uuid}`);
      const importInvocation = (0, _getDynamicImport.getDynamicImport)(loaderContext, assetPath, assetImport, {
        esModule,
        importVar
      });
      const importMeta = (0, _getDynamicMeta.getDynamicMeta)(assetPath, assetImport, {
        metaKey: 'assets',
        depsKey: assetPath.getHash(),
        importVar
      });
      return `
            ${importInvocation}
            ${importMeta}
            `;
    }).join('');
  }

  return {
    imports
  };
}