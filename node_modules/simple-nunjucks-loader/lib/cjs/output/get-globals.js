"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getGlobals = getGlobals;

var _loaderUtils = require("loader-utils");

var _constants = require("../constants");

var _getImportStr = require("../utils/get-import-str");

var _toVar = require("../utils/to-var");

var _getModuleOutput = require("./get-module-output");

function getGlobals(globals) {
  function imports(loaderContext, esModule) {
    return globals.map(([globalImport, globalPath]) => {
      const importVar = (0, _toVar.toVar)(`${_constants.IMPORTS_PREFIX}_global_${globalImport}`);
      const importStatement = (0, _getImportStr.getImportStr)((0, _loaderUtils.stringifyRequest)(loaderContext, globalPath), esModule)(importVar);
      return `
            ${importStatement}
            ${_constants.TEMPLATE_DEPENDENCIES}.globals['${globalImport}'] = {
                module: ${(0, _getModuleOutput.getModuleOutput)(importVar)}
            };`;
    }).join('');
  }

  return {
    imports
  };
}