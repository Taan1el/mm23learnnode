"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getFilters = getFilters;

var _loaderUtils = require("loader-utils");

var _constants = require("../constants");

var _getImportStr = require("../utils/get-import-str");

var _toVar = require("../utils/to-var");

var _getModuleOutput = require("./get-module-output");

function getFilters(filters) {
  function imports(loaderContext, esModule) {
    return filters.map(([filterName, importPath, filterInstance]) => {
      const importVar = (0, _toVar.toVar)(`${_constants.IMPORTS_PREFIX}_filter_${filterName}`);
      const importStatement = (0, _getImportStr.getImportStr)((0, _loaderUtils.stringifyRequest)(loaderContext, importPath), esModule)(importVar);
      return `
            ${importStatement}
            ${_constants.TEMPLATE_DEPENDENCIES}.filters['${filterName}'] = {
                module: ${(0, _getModuleOutput.getModuleOutput)(importVar)},
                async: ${JSON.stringify(filterInstance.async === true)}
            };`;
    }).join('');
  }

  return {
    imports
  };
}